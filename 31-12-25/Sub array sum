def subarraySum(nums, k):
    from collections import defaultdict
    d = defaultdict(int)
    d[0] = 1
    cur = res = 0
    for n in nums:
        cur += n
        res += d[cur-k]
        d[cur] += 1
    return res
